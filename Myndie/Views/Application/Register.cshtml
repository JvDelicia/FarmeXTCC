
@{
    Layout = "~/Views/Shared/_DeveloperLayout.cshtml";
}

<div id="DivContent">
    <section class="no-padding-top">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12">
                    <div class="block">
                        <div class="title"><strong>Add Application</strong></div>
                        <div class="block-body">
                            <form id="RegisterApp" class="needs-validation" method="post" enctype="multipart/form-data" onsubmit="return AjaxPostRegisterApp(this)">
                                <div class="row">
                                    <div class="col-md-6">
                                        <p>Name:</p>
                                        <div class="myndie-input">
                                            <input type="text" class="form-control" id="Name" value="@ViewBag.App.Name" placeholder="Name" required name="app.Name" />
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <p>Description:</p>
                                        <div class="myndie-input">
                                            <input type="text" class="form-control" id="Desc" value="@ViewBag.App.Desc" placeholder="Description" required name="app.Desc" />
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <p>Price:</p>
                                        <div class="myndie-input">
                                            <input type="number" class="form-control" id="Price" value="@ViewBag.App.Price" placeholder="Price" required name="app.Price" />
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <p>Version:</p>
                                        <div class="myndie-input">
                                            <input type="text" class="form-control" id="Version" value="@ViewBag.App.Version" placeholder="Version" required name="app.Version" />
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <p>Publisher Name:</p>
                                        <div class="myndie-input">
                                            <input type="text" class="form-control" id="PublisherName" value="@ViewBag.App.PublisherName" placeholder="Publisher Name" required name="app.PublisherName" />
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <p>Pegi:</p>
                                        <label class="myndie-select">
                                            <select class="custom-select" required id="app.PegiId" name="app.PegiId">
                                                @foreach (var p in ViewBag.Pegi)
                                                {
                                                    <option value="@p.Id" selected="@p.Id.Equals(ViewBag.App.PegiId)"> @p.Desc</option>
                                                }
                                            </select>
                                        </label>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <p>Release Date:</p>
                                        <div class="myndie-input">
                                            <input type="date" class="form-control" id="DateofBirth" value="@ViewBag.App.ReleaseDate" placeholder="" required name="app.ReleaseDate" />
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <p>Type:</p>
                                        <label class="myndie-select">
                                            <select class="custom-select" required id="app.TypeAppId" name="app.TypeAppId">
                                                @foreach (var t in ViewBag.Type)
                                                {
                                                    <option value="@t.Id" selected="@t.Id.Equals(ViewBag.App.TypeAppId)"> @t.Name</option>
                                                }
                                            </select>
                                        </label>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <p>File:</p>
                                        <div class="myndie-input">
                                            <input type="file" class="" id="File" value="@ViewBag.App.Archive" placeholder="Files" required name="File" />
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <p>Images:</p>
                                        <div class="myndie-input">
                                            <input type="file"
                                                   class="my-pond"
                                                   name="images"
                                                   multiple
                                                   id="my-pond"
                                                   data-max-file-size="3MB"
                                                   data-max-files="3"
                                                   accept="image/*">
                                        </div>
                                    </div>
                                </div>
                                <br /><br />


                                <br /><br />
                                <input type="submit" value="Add" class="btn btn-primary">
                            </form>
                            <br />
                            <div class="@ViewBag.Class" style="width:80%;" role="alert">
                                @Html.ValidationMessage("Application.Name")<br />
                                @Html.ValidationMessage("Application.Desc")<br />
                                @Html.ValidationMessage("Application.Version")<br />
                                @Html.ValidationMessage("Application.Price")<br />
                                @Html.ValidationMessage("Application.PublisherName")<br />
                                @Html.ValidationMessage("Application.ReleaseDate")<br />
                                @Html.ValidationMessage("Application.Archive")<br />
                            </div>
                        </div>
                        <script>
                            function AjaxPostRegisterApp(formData) {
                                alert("Wait... Uploading...")
                                var ajaxConfig = {
                                    type: "post",
                                    url: "/Application/Validate",
                                    data: new FormData(formData),
                                    success: function (result) {
                                        alert(result);
                                        if (result == "Successfully Registered") {
                                            window.location.href = "/Developer/ProfileView";
                                        }
                                        else if (result == "Error on Uploading Images, try later" || result == "Error on Uploading Files, try later") {
                                            window.location.href = "/Developer/ProfileView";
                                        }
                                    }
                                }
                                if ($(formData).attr('enctype') == "multipart/form-data") {
                                    ajaxConfig["contentType"] = false;
                                    ajaxConfig["processData"] = false;
                                }
                                $.ajax(ajaxConfig);
                                return false;
                            };
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>
