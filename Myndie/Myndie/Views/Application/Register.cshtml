@{
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Register</title>
</head>
<body>
    <div class="container">
        <center>
            <form id="RegisterApp" class="needs-validation" novalidate method="post" enctype="multipart/form-data" onsubmit="return AjaxPostRegisterApp(this)" >
                <div class="form-row">
                    <div class="col">
                        <label for="Name">Name</label>
                        <input type="text" class="form-control" id="Name" value="@ViewBag.App.Name" placeholder="Name" required name="app.Name" />
                        <div class="invalid-tooltip">
                            Please choose a valid Name.
                        </div>
                    </div>
                    <div class="col-6">
                        <label for="Desc">Description</label>
                        <input type="text" class="form-control" id="Desc" value="@ViewBag.App.Desc" placeholder="Description" required name="app.Desc" />
                        <div class="invalid-tooltip">
                            Please choose a valid Description.
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="col">
                        <label for="Price">Price</label>
                        <input type="text" class="form-control" id="Price" value="@ViewBag.App.Price" placeholder="Price" required name="app.Price" />
                        <div class="invalid-tooltip">
                            Please choose a valid Price.
                        </div>
                    </div>
                    <div class="col">
                        <label for="Version">Version</label>
                        <input type="text" class="form-control" id="Version" value="@ViewBag.App.Version" placeholder="Version" required name="app.Version" />
                        <div class="invalid-tooltip">
                            Please choose a valid Version.
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="col">
                        <label for="PublisherName">Publisher Name</label>
                        <input type="text" class="form-control" id="PublisherName" value="@ViewBag.App.PublisherName" placeholder="Publisher Name" required name="app.PublisherName" />
                        <div class="invalid-tooltip">
                            Please choose a valid Name.
                        </div>
                    </div>
                    <div class="col">
                        <label for="Archive">Archive Path</label>
                        <input type="text" class="form-control" id="Archive" value="@ViewBag.App.Archive" placeholder="Archive Path" required name="app.Archive" />
                        <div class="invalid-tooltip">
                            Please choose a valid Archive.
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="col-6">
                        <label for="ReleaseDate">Release Date</label>
                        <input type="date" class="form-control" id="DateofBirth" value="@ViewBag.App.ReleaseDate" placeholder="" required name="app.ReleaseDate" />
                        <div class="invalid-tooltip">
                            Please choose a valid Date.
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="col">
                        <label for="TypeApp">Type</label><br />
                        <select class="custom-select" required id="app.TypeAppId" name="app.TypeAppId">
                                @foreach (var c in ViewBag.Type){
                                    <option value="@c.Id" selected="@c.Id.Equals(ViewBag.App.TypeAppId)"> @c.Name</option>
                                }
                        </select>
                        <div class="invalid-tooltip">
                            Please choose a valid Type.
                        </div>
                    </div>
                    <div class="col">
                        <label for="Pegi">Pegi</label><br />
                        <select class="custom-select" required id="app.PegiId" name="app.PegiId">
                                @foreach (var p in ViewBag.Pegi){
                                    <option value="@p.Id" selected="@p.Id.Equals(ViewBag.App.PegiId)"> @p.Desc</option>
                                }
                        </select>
                        <div class="invalid-tooltip">
                            Please choose a valid Pegi.
                        </div>
                    </div>
                </div>
                <br /><br />
                <input type="submit" value="Register" class="btn btn-danger" />
            </form>
            <br />
            <div class="@ViewBag.Class" style="width:80%;" role="alert">
                @Html.ValidationMessage("Application.Name")<br />
                @Html.ValidationMessage("Application.Desc")<br />
                @Html.ValidationMessage("Application.Version")<br />
                @Html.ValidationMessage("Application.Price")<br />
                @Html.ValidationMessage("Application.PublisherName")<br />
                @Html.ValidationMessage("Application.ReleaseDate")<br />
                @Html.ValidationMessage("Application.Archive")<br />
            </div>
        </center>
    </div>

    <script>
        (function () {
            'use strict';
            window.addEventListener('load', function () {
                // Fetch all the forms we want to apply custom Bootstrap validation styles to
                var forms = document.getElementsByClassName('needs-validation');
                // Loop over them and prevent submission
                var validation = Array.prototype.filter.call(forms, function (form) {
                    form.addEventListener('submit', function (event) {
                        if (form.checkValidity() === false) {
                            event.preventDefault();
                            event.stopPropagation();
                        }
                        form.classList.add('was-validated');
                    }, false);
                });
            }, false);
        })();
    </script>
    <script>
        function AjaxPostRegisterApp(formData) {
            var ajaxConfig = {
                type: "post",
                url: "/Application/Validate",
                data: new FormData(formData),
                success: function (result) {
                    alert(result);
                    if (result == "Successfully Registered") {
                        window.location.href = "/Application/Register";
                    }
                }
            }
            if ($(formData).attr('enctype') == "multipart/form-data") {
                ajaxConfig["contentType"] = false;
                ajaxConfig["processData"] = false;
            }
            $.ajax(ajaxConfig);
            return false;
        }
    </script>

</body>

</html>
